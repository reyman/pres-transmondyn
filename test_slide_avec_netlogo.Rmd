---
title: "Transmondyn"
author: "Rey; Cura"
date: "22/10/2014"
output: ioslides_presentation
runtime: shiny
---

## Shiny Presentation

This R Markdown presentation is made interactive using Shiny. The viewers of the presentation can change the assumptions underlying what's presented and see the results immediately. 

To learn more, see [Interactive Documents](http://rmarkdown.rstudio.com/authoring_shiny.html).

## Slide with Interactive Plot (1)
```{r, echo=FALSE}
library(RNetLogo)
library(ggplot2)

currentUser <- as.list(Sys.info())$user
currentSys <- as.list(Sys.info())$sysname
if (currentUser  == "robin"){
	if (currentSys == "Windows"){
		nlDir <- "C:\\Program Files (x86)\\NetLogo 5.0.4\\"
		model.path <- "D:\\repositories\\pres-transmondyn\\ColonDyn12.nlogo"
	} else {
		nlDir <- "/home/robin/Downloads/netlogo-5.0.5/"
		model.path <- "/data/repositories/pres-transmondyn/ColonDyn12.nlogo"
	}
} else {
  nlDir <- "/home/srey/Binaire/netlogo-5.0.4/"
  model.path <- "/data/repositories/pres-transmondyn/ColonDyn12.nlogo"
}

NLStart(nlDir, gui = TRUE) # start NetLogo "headless"
 
NLLoadModel(model.path)

NLCommand('set Resource_Landscape "U-turn"')
NLCommand('set Ressource-regeneration 1')
NLCommand('set human-pressure-on-ecology 150')
NLCommand('set migration-cost 80')
NLCommand('set Migration-rule "Maximisation of ressource"')

NLCommand("setup")
results <- NLDoReportWhile("(any? groups) and (ticks < 1000)", "go",
                c("ticks", "globaldensity", "meanlocaldensity", "count groups"),
                as.data.frame = TRUE, df.col.names = c("tick", "Global_Density", "Local_Density", "Number_of_Groups"))
# Plot with ggplot2
p <- ggplot(results)
p + geom_line(aes(x=tick,y=Global_Density, colour = "red")) + 
  geom_line(aes(x=tick,y=Local_Density, colour = "blue")) + 
  geom_line(aes(x=tick,y=Number_of_Groups, colour = "grey")) + 
  scale_colour_manual(name = 'Indicateurs', values =c('grey'='grey','red'='red','blue'='blue'), labels = c('Densité locale', "Nombre de groupes en vie", 'Densité globale')) + 
  ggtitle("ColoDyn results")
NLQuit()
```


